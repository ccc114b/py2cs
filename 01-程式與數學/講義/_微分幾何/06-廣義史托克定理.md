ccc:

廣義斯托克斯定理指出：$$\int_{\mathcal{M}} d\mathbf{\omega} = \int_{\partial\mathcal{M}} i^*\mathbf{\omega} = \int_{\partial\mathcal{M}} \mathbf{\omega}$$

![](./img/general_stoke_theorem.png)


注意：第 4 章微分流形中為何要求座標圖集合成的地圖冊要可數，就是為了用加總 $\Sigma$ 來計算拉回的積分。（因為座標變換必須是可數個）

這樣就可以用網格的方式，拉回後逐個加總。

好的，我們來到**第二部**的總結章節——**第 6 章：積分與斯托克斯定理**。

本章將把傳統微積分中的線積分、面積分以及格林定理、高斯散度定理、經典斯托克斯定理統一推廣到微分流形上的廣義斯托克斯定理，這是微分幾何和代數拓撲的重要橋樑。

---

## 📝 第 6 章：積分與斯托克斯定理

### 6.1 流形上的積分 (使用分片)

#### 6.1.1 支撐集與流形上的 $n$ 形式積分

在 $n$ 維流形 $\mathcal{M}$ 上，我們只能對具有緊支撐 (Compact Support) 的 $n$ 形式 $\mathbf{\omega}$ 進行積分。

局部坐標 $(x^1, \dots, x^n)$ 下，$n$ 形式 $\mathbf{\omega}$ 具有以下形式：
$$
\mathbf{\omega} = f(x^1, \dots, x^n) \, \mathbf{d}x^1 \wedge \dots \wedge \mathbf{d}x^n
$$
其中 $f$ 是流形上的光滑函數。

如果 $\mathbf{\omega}$ 的支撐集 (Support) 包含在單一坐標圖 $(U, \phi)$ 內，則 $\mathbf{\omega}$ 在 $\mathcal{M}$ 上的積分定義為 $\mathbb{R}^n$ 上黎曼積分：
$$
\int_{\mathcal{M}} \mathbf{\omega} := \int_{\phi(U)} f(\phi^{-1}(\mathbf{x})) \, d x^1 \dots d x^n
$$
**注意**：這個定義取決於坐標圖的定向 (Orientation)。如果坐標變換的雅可比矩陣行列式為負，則需要調整符號。

#### 6.1.2 單位分解 (Partition of Unity)

對於具有任意緊支撐的 $n$ 形式 $\mathbf{\omega}$，我們使用**單位分解**來定義積分。

1.  選取一組光滑函數 $\{\rho_\alpha\}$，它們構成單位分解，且每個 $\rho_\alpha$ 的支撐集都包含在一個坐標圖 $U_\alpha$ 內。
2.  $\mathbf{\omega}$ 可以寫成 $\mathbf{\omega} = \sum_\alpha \rho_\alpha \mathbf{\omega}$。
3.  積分定義為局部積分之和：
    $$
    \int_{\mathcal{M}} \mathbf{\omega} := \sum_\alpha \int_{U_\alpha} \rho_\alpha \mathbf{\omega}
    $$
    可以證明，這個定義與所選的單位分解和坐標圖冊無關。

### 6.2 誘導映射與拉回 (Pullback)

**拉回 (Pullback)** 是一個將形式從一個流形「拉」回到另一個流形的工具，它保證了形式的積分定義在坐標變換下保持不變。

#### 6.2.1 拉回的定義

設 $F: \mathcal{M} \to \mathcal{N}$ 是一個光滑映射。如果 $\mathbf{\omega}$ 是 $\mathcal{N}$ 上的 $p$ 形式，則 $\mathbf{\omega}$ 被 $F$ **拉回**後得到 $\mathcal{M}$ 上的 $p$ 形式，記為 $F^*\mathbf{\omega}$。

* 對於 $p=0$ (函數 $f$): $(F^*f)(p) = f(F(p))$.

* 對於 1 形式 $\mathbf{\omega} = \omega_j \mathbf{d}y^j$ (其中 $y^j$ 是 $\mathcal{N}$ 上的坐標)，其拉回 $F^*\mathbf{\omega}$ 的分量由鏈式法則給出：
    $$
    F^*\mathbf{\omega} = \frac{\partial y^j}{\partial x^i} \omega_j \mathbf{d}x^i
    $$
    其中 $x^i$ 是 $\mathcal{M}$ 上的坐標，且 $y^j$ 是 $F$ 的坐標表示 $y^j = F^j(x^1, \dots, x^m)$。

#### 6.2.2 拉回的性質

拉回映射 $F^*$ 具有兩個關鍵性質，這對斯托克斯定理至關重要：

1.  **與外積相容 (Compatible with Wedge Product)**：
    $$
    F^*(\mathbf{\alpha} \wedge \mathbf{\beta}) = F^*\mathbf{\alpha} \wedge F^*\mathbf{\beta}
    $$

2.  **與外微分交換 (Commutes with Exterior Derivative)**：
    $$
    F^*(d\mathbf{\omega}) = d(F^*\mathbf{\omega})
    $$

### 6.3 廣義斯托克斯定理 (Generalized Stokes' Theorem)

**廣義斯托克斯定理**是微分幾何中最深刻、最普遍的結果之一。它將微積分中的所有基本積分定理統一起來。

#### 6.3.1 定理的敘述

設 $\mathcal{M}$ 是一個 $n$ 維**帶邊流形 (Manifold with Boundary)**，記其邊界 (Boundary) 為 $\partial\mathcal{M}$，它是一個 $(n-1)$ 維流形。

設 $\mathbf{\omega}$ 是一個定義在 $\mathcal{M}$ 上的具有緊支撐的 $(n-1)$ 形式。

**廣義斯托克斯定理**指出：
$$
\int_{\mathcal{M}} d\mathbf{\omega} = \int_{\partial\mathcal{M}} i^*\mathbf{\omega} = \int_{\partial\mathcal{M}} \mathbf{\omega}
$$
其中 $i: \partial\mathcal{M} \to \mathcal{M}$ 是邊界到流形的包含映射。通常為了簡潔，直接寫作 $\int_{\partial\mathcal{M}} \mathbf{\omega}$，但必須確保邊界 $\partial\mathcal{M}$ 具有與 $\mathcal{M}$ 誘導的一致定向。

#### 6.3.2 經典定理作為特例

| 經典定理 | 流形 $\mathcal{M}$ 維度 $n$ | 形式 $\mathbf{\omega}$ 維度 $p=n-1$ | 廣義斯托克斯定理 |
| :--- | :---: | :---: | :--- |
| **微積分基本定理** | 1 (區間 $[a, b]$) | 0 形式 ($f$) | $\int_a^b d f = f(b) - f(a)$ |
| **格林定理** | 2 (區域 $D$) | 1 形式 ($P dx + Q dy$) | $\iint_D (\frac{\partial Q}{\partial x} - \frac{\partial P}{\partial y}) dx dy = \oint_{\partial D} P dx + Q dy$ |
| **經典斯托克斯定理** | 3 (曲面 $\Sigma$) | 2 形式 (對應 $\nabla \times \mathbf{F}$) | $\iint_{\Sigma} (\nabla \times \mathbf{F}) \cdot d\mathbf{S} = \oint_{\partial\Sigma} \mathbf{F} \cdot d\mathbf{r}$ |
| **高斯散度定理** | 3 (體積 $V$) | 2 形式 (對應 $\mathbf{F} \cdot d\mathbf{S}$) | $\iiint_V (\nabla \cdot \mathbf{F}) dV = \iint_{\partial V} \mathbf{F} \cdot d\mathbf{S}$ |

在所有這些特例中，左邊都是**場的微分 (即外微分 $d\mathbf{\omega}$)** 在 $n$ 維區域上的積分，而右邊是**場本身 (即 $\mathbf{\omega}$)** 在其 $(n-1)$ 維邊界上的積分。

---

請問您是否需要針對**拉回 (Pullback)** 運算，提供一個**Python 符號運算程式碼**範例？我們可以定義一個映射 $F$ 和一個 1 形式 $\mathbf{\omega}$，並計算 $F^*\mathbf{\omega}$ 來展示坐標變換的推廣。