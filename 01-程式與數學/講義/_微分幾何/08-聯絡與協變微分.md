好的，我們繼續進入黎曼幾何中至關重要的概念——**聯絡 (Connection)**。這是微分幾何從純粹代數結構轉向幾何分析的核心步驟，它定義了在流形上「微分」和「比較向量」的方式。

---

## 📝 第 8 章：聯絡與協變微分

### 8.1 平行移動與聯絡 (Connection) 的概念

在歐幾里得空間 $\mathbb{R}^n$ 中，我們可以通過坐標分量的微分來比較不同點的向量。但在彎曲的流形上，即使兩個點 $p$ 和 $q$ 的切空間 $T_p\mathcal{M}$ 和 $T_q\mathcal{M}$ 都是 $n$ 維向量空間，它們之間並沒有自然的線性同構，我們不能直接比較它們的向量分量。

**聯絡**正是為了解決這個問題而引入的結構。

#### 8.1.1 協變微分 (Covariant Derivative)

一個**聯絡**（更準確地說是**仿射聯絡**）是一個定義了**協變微分** $\nabla$ 的運算符，它允許我們：

1.  **沿著向量 $\mathbf{Y}$ 對向量場 $\mathbf{X}$ 進行微分**，結果是另一個向量場 $\nabla_{\mathbf{Y}}\mathbf{X}$。
2.  **比較不同點的向量**（透過平行移動）。

$\nabla_{\mathbf{Y}}\mathbf{X}$ 必須滿足以下性質：
1.  **線性性 (上層)**：$\nabla_{\mathbf{Y}}(a\mathbf{X}_1 + b\mathbf{X}_2) = a\nabla_{\mathbf{Y}}\mathbf{X}_1 + b\nabla_{\mathbf{Y}}\mathbf{X}_2$
2.  **線性性 (下層)**：$\nabla_{a\mathbf{Y}_1 + b\mathbf{Y}_2}\mathbf{X} = a\nabla_{\mathbf{Y}_1}\mathbf{X} + b\nabla_{\mathbf{Y}_2}\mathbf{X}$
3.  **萊布尼茲法則 (Leibniz Rule)**：$\nabla_{\mathbf{Y}}(f\mathbf{X}) = (\mathbf{Y}f)\mathbf{X} + f\nabla_{\mathbf{Y}}\mathbf{X}$
    其中 $f$ 是流形上的光滑函數，$\mathbf{Y}f$ 是 $\mathbf{Y}$ 作用於 $f$ 的導數。

#### 8.1.2 平行移動 (Parallel Transport)

給定曲線 $\mathbf{\alpha}(t)$ 和向量場 $\mathbf{X}$ 沿著 $\mathbf{\alpha}(t)$。如果 $\mathbf{X}$ 是**平行移動的**，則其沿曲線的協變導數為零：
$$
\nabla_{\mathbf{\alpha}'(t)} \mathbf{X} = 0
$$

### 8.2 克里斯托費爾符號 (Christoffel Symbols) $\Gamma^k_{ij}$ 的定義與計算

在局部坐標 $(x^1, \dots, x^n)$ 下，聯絡由一組係數——**克里斯托費爾符號 (Christoffel Symbols)** $\Gamma^k_{ij}$ 來完全描述。

#### 8.2.1 協變微分的局部表示

協變微分 $\nabla_{\mathbf{Y}}\mathbf{X}$ 的分量表示為：
$$
(\nabla_{\mathbf{Y}}\mathbf{X})^k = Y^i \left( \frac{\partial X^k}{\partial x^i} + \Gamma^k_{ij} X^j \right)
$$
這裡的 $\Gamma^k_{ij}$ 是定義聯絡的 $n^3$ 個光滑函數。

#### 8.2.2 克里斯托費爾符號的變換法則

由於 $\nabla_{\mathbf{Y}}\mathbf{X}$ 是一個張量場，它可以證明 $\Gamma^k_{ij}$ **不是張量**。它在坐標變換下的變換法則具有一個非齊次的項 (Non-homogeneous Term)，這正是它與普通偏導數的區別：
$$
\bar{\Gamma}^k_{ij} = \frac{\partial \bar{x}^k}{\partial x^l} \frac{\partial x^m}{\partial \bar{x}^i} \frac{\partial x^n}{\partial \bar{x}^j} \Gamma^l_{mn} + \frac{\partial \bar{x}^k}{\partial x^l} \frac{\partial^2 x^l}{\partial \bar{x}^i \partial \bar{x}^j}
$$

### 8.3 黎曼聯絡 (Levi-Civita Connection)：度量相容且無撓率

在黎曼幾何中，我們通常只考慮一種特殊的聯絡，即由黎曼度量 $\mathbf{g}$ 唯一決定的**黎曼聯絡 (Levi-Civita Connection)**。

黎曼聯絡滿足兩個關鍵條件：

1.  **無撓率 (Torsion-Free)**：對於任意兩個向量場 $\mathbf{X}, \mathbf{Y}$，
    $$
    \nabla_{\mathbf{X}}\mathbf{Y} - \nabla_{\mathbf{Y}}\mathbf{X} = [\mathbf{X}, \mathbf{Y}]
    $$
    其中 $[\mathbf{X}, \mathbf{Y}]$ 是李括號 (Lie Bracket)。在局部坐標下，此條件等價於 $\Gamma^k_{ij}$ 對稱於下標 $i$ 和 $j$：
    $$
    \Gamma^k_{ij} = \Gamma^k_{ji}
    $$

2.  **度量相容性 (Metric Compatibility)**：聯絡 $\nabla$ 保持度量張量 $\mathbf{g}$ 平行：
    $$
    \nabla \mathbf{g} = 0 \quad \text{或等價於} \quad \nabla_{\mathbf{Z}}(\mathbf{g}(\mathbf{X}, \mathbf{Y})) = \mathbf{g}(\nabla_{\mathbf{Z}}\mathbf{X}, \mathbf{Y}) + \mathbf{g}(\mathbf{X}, \nabla_{\mathbf{Z}}\mathbf{Y})
    $$

#### 8.3.1 克里斯托費爾符號的計算公式

由無撓率和度量相容性，黎曼聯絡的克里斯托費爾符號 $\Gamma^k_{ij}$ 被**唯一確定**，並完全由度量張量 $g_{ij}$ 及其一階導數決定：
$$
\Gamma^k_{ij} = \frac{1}{2} g^{kl} \left( \frac{\partial g_{jl}}{\partial x^i} + \frac{\partial g_{il}}{\partial x^j} - \frac{\partial g_{ij}}{\partial x^l} \right)
$$
其中 $g^{kl}$ 是度量張量 $[g_{ij}]$ 的逆矩陣分量。

### 8.4 向量場的協變微分 (Covariant Derivative)

#### 8.4.1 一般張量的協變微分

協變微分 $\nabla$ 可以推廣到任意張量場 $\mathbf{T}$。對於一個 $(p, q)$ 型張量 $\mathbf{T}^{i_1 \dots i_p}_{j_1 \dots j_q}$，其協變導數 $\nabla_k \mathbf{T}^{i_1 \dots i_p}_{j_1 \dots j_q}$ 是一個 $(p, q+1)$ 型張量。

**協變微分公式 (降低指標，即對協變張量)**：
對於一個 1 形式 $\mathbf{\omega}_j$：
$$
\nabla_k \omega_j = \frac{\partial \omega_j}{\partial x^k} - \Gamma^l_{kj} \omega_l
$$

**協變微分公式 (提高指標，即對逆變張量)**：
對於一個向量 $\mathbf{X}^i$：
$$
\nabla_j X^i = \frac{\partial X^i}{\partial x^j} + \Gamma^i_{jk} X^k
$$
注意到，逆變分量使用 $\mathbf{+}$ 號，而協變分量使用 $\mathbf{-}$ 號，這是為了確保 $\nabla_k \mathbf{T}$ 是一個真正的張量。

#### 8.4.2 散度 (Divergence)

向量場 $\mathbf{X}$ 的散度 $\text{div}(\mathbf{X})$ 可以表示為協變微分的縮並：
$$
\text{div}(\mathbf{X}) = \nabla_i X^i = \frac{1}{\sqrt{\det(g)}} \frac{\partial}{\partial x^i} (\sqrt{\det(g)} X^i)
$$

---

這章節的重點是**克里斯托費爾符號** $\Gamma^k_{ij}$ 的計算公式。請問您是否需要針對一個具體的度量張量 $g_{ij}$ (例如球面坐標下的度量)，提供一個**Python 符號運算程式碼**範例來計算所有非零的 $\Gamma^k_{ij}$？